{% load static %}
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Управление справочниками</title>
        <link rel="stylesheet"
              href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
        <style>
            .list-group-item .delete-btn {
                visibility: hidden;
            }
            .list-group-item:hover .delete-btn {
                visibility: visible;
            }
            .delete-form {
                display: inline;
            }
        </style>
    </head>
    <body>
        <div class="container mt-4">
            <h1>Управление справочниками</h1>
            <a href="{% url 'records_list' %}" class="btn btn-secondary mb-3">← Назад</a>
            <div class="row g-4">
                <!-- Статусы -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-light">
                            <strong>Статусы</strong>
                        </div>
                        <div class="card-body">
                            <form method="post" class="mb-3">
                                {% csrf_token %}
                                {{ status_form.name }}
                                <input type="hidden" name="form_type" value="status">
                                <button class="btn btn-success btn-sm">Добавить</button>
                            </form>
                            <ul class="list-group">
                                {% for s in statuses %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        {{ s.name }}
                                        <form action="{% url 'delete_status' s.id %}" method="post" class="delete-form">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-danger btn-sm delete-btn" onclick="return confirm('Вы уверены, что хотите удалить этот статус?');">Удалить</button>
                                        </form>
                                    </li>
                                {% empty %}
                                    <li class="list-group-item text-muted">Нет статусов</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Типы -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-light">
                            <strong>Типы</strong>
                        </div>
                        <div class="card-body">
                            <form method="post" class="mb-3">
                                {% csrf_token %}
                                {{ type_form.name }}
                                <input type="hidden" name="form_type" value="type">
                                <button class="btn btn-success btn-sm">Добавить</button>
                            </form>
                            <ul class="list-group">
                                {% for t in types %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        {{ t.name }}
                                        <form action="{% url 'delete_type' t.id %}" method="post" class="delete-form">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-danger btn-sm delete-btn" onclick="return confirm('Вы уверены, что хотите удалить этот тип?');">Удалить</button>
                                        </form>
                                    </li>
                                {% empty %}
                                    <li class="list-group-item text-muted">Нет типов</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Категории -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-light">
                            <strong>Категории</strong>
                        </div>
                        <div class="card-body">
                            <form method="post" class="mb-3">
                                {% csrf_token %}
                                {{ category_form.name }}
                                {{ category_form.type }}
                                <input type="hidden" name="form_type" value="category">
                                <button class="btn btn-success btn-sm">Добавить</button>
                            </form>
                            <ul class="list-group">
                                {% for c in categories %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        {{ c.name }} <small class="text-muted">({{ c.type.name }})</small>
                                        <form action="{% url 'delete_category' c.id %}" method="post" class="delete-form">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-danger btn-sm delete-btn" onclick="return confirm('Вы уверены, что хотите удалить эту категорию?');">Удалить</button>
                                        </form>
                                    </li>
                                {% empty %}
                                    <li class="list-group-item text-muted">Нет категорий</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
                <!-- Подкатегории -->
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header bg-light">
                            <strong>Подкатегории</strong>
                        </div>
                        <div class="card-body">
                            <form method="post" class="mb-3">
                                {% csrf_token %}
                                {{ subcategory_form.name }}
                                {{ subcategory_form.category }}
                                <input type="hidden" name="form_type" value="subcategory">
                                <button class="btn btn-success btn-sm">Добавить</button>
                            </form>
                            <ul class="list-group">
                                {% for sc in subcategories %}
                                    <li class="list-group-item d-flex justify-content-between align-items-center">
                                        {{ sc.name }} <small class="text-muted">({{ sc.category.name }})</small>
                                        <form action="{% url 'delete_subcategory' sc.id %}" method="post" class="delete-form">
                                            {% csrf_token %}
                                            <button type="submit" class="btn btn-danger btn-sm delete-btn" onclick="return confirm('Вы уверены, что хотите удалить эту подкатегорию?');">Удалить</button>
                                        </form>
                                    </li>
                                {% empty %}
                                    <li class="list-group-item text-muted">Нет подкатегорий</li>
                                {% endfor %}
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
